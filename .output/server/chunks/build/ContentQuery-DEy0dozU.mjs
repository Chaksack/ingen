import{Q as e}from"../nitro/nitro.mjs";import{defineComponent as r,useSlots as t,h as i,toRefs as o,computed as u,watch as n,useSSRContext as l}from"vue";import{a,q as d}from"./query-U8U6f_VV.mjs";import{b as s}from"./server.mjs";import"unist-util-visit";import"hast-util-to-string";import"node:http";import"node:https";import"node:events";import"node:buffer";import"node:fs";import"node:path";import"node:crypto";import"consola";import"@unhead/schema-org/vue";import"node:url";import"unified";import"mdast-util-to-string";import"micromark";import"unist-util-stringify-position";import"micromark-util-character";import"micromark-util-chunked";import"micromark-util-resolve-all";import"micromark-util-sanitize-uri";import"slugify";import"remark-parse";import"remark-rehype";import"remark-mdc";import"remark-gfm";import"rehype-external-links";import"rehype-sort-attribute-values";import"rehype-sort-attributes";import"rehype-raw";import"detab";import"github-slugger";import"unhead/server";import"unhead/utils";import"unhead/plugins";import"vue-bundle-renderer/runtime";import"vue/server-renderer";import"ipx";import"perfect-debounce";import"./preview-CyjoVtle.mjs";import"vue-router";const p=r({name:"ContentQuery",props:{path:{type:String,required:!1,default:void 0},only:{type:Array,required:!1,default:void 0},without:{type:Array,required:!1,default:void 0},where:{type:Object,required:!1,default:void 0},sort:{type:Object,required:!1,default:void 0},limit:{type:Number,required:!1,default:void 0},skip:{type:Number,required:!1,default:void 0},locale:{type:String,required:!1,default:void 0},find:{type:String,required:!1,default:void 0}},async setup(r){const{path:t,only:i,without:l,where:p,sort:m,limit:v,skip:h,locale:f,find:y}=o(r),c=u(()=>{var e;return null==(e=t.value)?void 0:e.includes("/_")}),w=!s().public.content.experimental.advanceQuery;n(()=>r,()=>k(),{deep:!0});const resolveResult=e=>w?(null==e?void 0:e.surround)?e.surround:(null==e?void 0:e._id)||Array.isArray(e)?e:null==e?void 0:e.result:e.result,{data:g,refresh:k}=await a(`content-query-${e(r)}`,()=>{let e;return e=t.value?d(t.value):d(),i.value&&(e=e.only(i.value)),l.value&&(e=e.without(l.value)),p.value&&(e=e.where(p.value)),m.value&&(e=e.sort(m.value)),v.value&&(e=e.limit(v.value)),h.value&&(e=e.skip(h.value)),f.value&&(e=e.where({_locale:f.value})),"one"===y.value?e.findOne().then(resolveResult):"surround"===y.value?t.value?w?e.findSurround(t.value):e.withSurround(t.value).findOne().then(resolveResult):(console.warn("[Content] Surround queries requires `path` prop to be set."),console.warn("[Content] Query without `path` will return regular `find()` results."),e.find().then(resolveResult)):e.find().then(resolveResult)});return{isPartial:c,data:g,refresh:k}},render(e){var r;const o=t(),{data:u,refresh:n,isPartial:l,path:a,only:d,without:s,where:p,sort:m,limit:v,skip:h,locale:f,find:y}=e,c={path:a,only:d,without:s,where:p,sort:m,limit:v,skip:h,locale:f,find:y};if("one"===c.find){if(!u&&(null==o?void 0:o["not-found"]))return o["not-found"]({props:c,...this.$attrs});if((null==o?void 0:o.empty)&&"markdown"===(null==u?void 0:u._type)&&!(null==(r=null==u?void 0:u.body)?void 0:r.children.length))return o.empty({props:c,...this.$attrs})}else if((!u||!u.length)&&(null==o?void 0:o["not-found"]))return o["not-found"]({props:c,...this.$attrs});if(null==o?void 0:o.default)return o.default({data:u,refresh:n,isPartial:l,props:c,...this.$attrs});return w="default",g={data:u,props:c,isPartial:l},i("pre",null,JSON.stringify({message:"You should use slots with <ContentQuery>!",slot:w,data:g},null,2));var w,g}}),m=p.setup;p.setup=(e,r)=>{const t=l();return(t.modules||(t.modules=new Set)).add("node_modules/@nuxt/content/dist/runtime/components/ContentQuery.vue"),m?m(e,r):void 0};export{p as default};
//# sourceMappingURL=ContentQuery-DEy0dozU.mjs.map
